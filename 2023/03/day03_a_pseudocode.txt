DECLARE Dictionary<[row,column]:Integer> partNumbers

OPEN "input.txt" as inputFile
    PARSE inputFile AS a 2-D Character Array
    FOR EACH row IN inputFileArray:
        FOR EACH column IN row:
            IF column.value IS A SYMBOL:
                CALL CheckAdjacentCells(row, column)
            END-IF
        END-FOR
    END-FOR
CLOSE inputFile

// Calculate total calibration value
INITIALIZE totalCalibrationValue = 0
FOR EACH location IN partNumbers:
    ADD partNumbers[location] TO totalCalibrationValue
END-FOR


FUNCTION CheckAdjacentCells(current row, current column):
    INITIALIZE prevRow = current row - 1
    INITIALIZE nextRow = current row + 1
    INITIALIZE prevColumn = current column - 1
    INITIALIZE nextColumn = current column + 1
    // Check upper-left cell
    IF partNumbers[prevRow, prevColumn] DOES NOT EXIST:
        IF inputFileArray[prevRow, prevColumn] IS A NUMBER:
            MAP inputFileArray[prevRow, prevColumn] to partNumbers[prevRow, prevColumn]
        END-IF
    END-IF
    // Check above cell
    IF partNumbers[prevRow, current column] DOES NOT EXIST:
        IF inputFileArray[prevRow, current column] IS A NUMBER:
            MAP inputFileArray[prevRow, current column] to partNumbers[prevRow, current column]
        END-IF
    END-IF
    // Check upper-right cell
    IF partNumbers[prevRow, nextColumn] DOES NOT EXIST:
        IF inputFileArray[prevRow, nextColumn] IS A NUMBER:
            MAP inputFileArray[prevRow, nextColumn] to partNumbers[prevRow, nextColumn]
        END-IF
    END-IF
    // Check left cell
    IF partNumbers[current row, prevColumn] DOES NOT EXIST:
        IF inputFileArray[current row, prevColumn] IS A NUMBER:
            MAP inputFileArray[current row, prevColumn] to partNumbers[current row, prevColumn]
        END-IF
    END-IF
    // Check right cell
    IF partNumbers[current row, nextColumn] DOES NOT EXIST:
        IF inputFileArray[current row, nextColumn] IS A NUMBER:
            MAP inputFileArray[current row, nextColumn] to partNumbers[current row, nextColumn]
        END-IF
    END-IF
    // Check lower-left cell
    IF partNumbers[nextRow, prevColumn] DOES NOT EXIST:
        IF inputFileArray[nextRow, prevColumn] IS A NUMBER:
            MAP inputFileArray[nextRow, prevColumn] to partNumbers[nextRow, prevColumn]
        END-IF
    END-IF
    // Check below cell
    IF partNumbers[nextRow, current column] DOES NOT EXIST:
        IF inputFileArray[nextRow, current column] IS A NUMBER:
            MAP inputFileArray[nextRow, current column] to partNumbers[nextRow, current column]
        END-IF
    END-IF
    // Check lower-right cell
    IF partNumbers[nextRow, nextColumn] DOES NOT EXIST:
        IF inputFileArray[nextRow, nextColumn] IS A NUMBER:
            MAP inputFileArray[nextRow, nextColumn] to partNumbers[nextRow, nextColumn]
        END-IF
    END-IF
END-FUNCTION
